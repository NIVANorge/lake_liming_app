---
title: "Lake modelling"
number-sections: true
---

The calculations performed by the application and described on this page are a subset of those implemented by the original [TPKALK application](https://niva.brage.unit.no/niva-xmlui/handle/11250/208709) developed by NIVA during the 1990s.

## Types of lime {#sec-lime-types}

Lime products used for catchment management are usually a mixture of **calcium carbonate** (calcite, $CaCO_3$) and **magnesium carbonate** ($MgCO_3$). Rocks composed primarily of $CaCO_3$ are commonly called **limestones**, whereas carbonate rocks with significant proportions of magnesium are called **dolomites** or dolomitic limestones.

Lime manufacturers will typically specify the proportion of calcium and magnesium carbonate in their products. For example, `Microdol5` is reported as being 53.7% $CaCO_3$ and 44.4% $MgCO_3$ by mass (with 1.9% other impurities).

Magnesium carbonate has a higher acid neutralising capacity (ANC) than calcium carbonate: 1 g of magnesium carbonate will neutralise as much acid as 1.19 g of calcium carbonate. When comparing limes with different compositions, it is therefore common to multiply the magnesium carbonate proportion by a factor of 1.19. This gives a **total neutralising value (TNV)**, estimated as the sum of calcium carbonate *equivalents* (e.g. @tbl-nv). 

+-------------+---------------+-------------+---------+
| **Parameter**               |**Microdol5**| **VK3** |
+=============+===============+=============+=========+
|**Calcium**  |- CaCO3 (%)    |        53.7 |    99.0 |
+-------------+---------------+-------------+---------+
|**Magnesium**|- MgCO3 (%)    |        44.4 |     1.0 |
|             |- CaCO3-ekv (%)|        52.8 |     1.2 |
+-------------+---------------+-------------+---------+
|**TNV** (sum of CaCO3-ekv; %)|       106.5 |   100.2 |
+-------------+---------------+-------------+---------+

: Estimating the **total neutralising value (TNV)** for two lime products. $MgCO_3$ content is converted to $CaCO_3$-equivalents by multiplying by 1.19. {#tbl-nv}

TNV is usually specified in percent: pure calcium carbonate has a TNV of 100 %, pure magnesium carbonate has a TNV of 119 %, and typical dolomite products have TNVs that are somewhere in between. Weight for weight, products with a higher TNV will be more effective at increasing pH, *as long as all the lime dissolves*. In practice, different limes exhibit different dissolution rates, which must also be accounted for.

## Lime solubility {#sec-solubility}

Several factors affect the dissolution rate of lime material added to a waterbody. These include:

 * **Physical** and **chemical** properties of the lime (crystal structure etc.).

 * **Particle size** (i.e. fineness) of the lime material - smaller particles give a larger reaction surface and therefore dissolve faster.

 * **Water pH** - more acidic lakes react with the lime more vigorously.

 * **Application method** (for example from a boat versus from a helicopter).

 * Amount of lime added, usually called the **dose**. If large amounts of lime are added to a lake all at once, the overall effect on pH is less than might be achieved if smaller amounts were added more regularly. This is because, at high doses, pH and calcium concentration increase in the immediate vicinity of the lime particles, which then sink to the bottom without dissolving efficiently. It is also more likely that lime particles will clump together and sink more rapidly. This effect is called **overdosing**.

 Most commercial lime products are fine enough to dissolve effectively. For a given application method and lake pH, the goal is therefore to identify **which lime product to use** (i.e. which physical and chemical properties to select) and **in what dose** (to minimise the number of applications necessary, without excessive waste due to overdosing). 

 Lime dissolution rates and the effects of overdosing are determined experimentally - see the [Column tests](./column-tests.qmd) page for details.

## Relationships between Ca and pH {#sec-ca-ph}

A simple empirical relationship between pH and change in calcium concentration is given in @eq-ph-ca

$$
pH = pH_0 + A_{pH} log(\Delta Ca)
$$ {#eq-ph-ca}

where $pH$ is the expected pH *after* liming; $pH_0$ and $A_{pH}$ are constants determined by lake properties; and $\Delta Ca$ is the change in calcium concentration due to liming expressed in $\mu ekv/l$ (i.e. micro-moles of charge).

::: {.callout-note}
We need to check this equation, as its physical interpretation seems questionable: it only makes sense for $\Delta Ca \geq 1$; adding smaller amounts of Ca than this actually *reduces* the pH. Furthermore, if $\Delta Ca$ is zero, the result is undefined, whereas I would expect the change in pH for this case to be zero and for $pH_0$ to reflect the pH before liming. Wouldn't it make more sense to either regress expected change in pH against change in Ca, or simply pH against Ca?
:::

For any given lake, if detailed measurements of pH and calcium concentration are available before and after liming, the parameters $pH_0$ and $A_{pH}$ can be estimated from @eq-ph-ca using linear regression. If measured data are not available, the [TPKALK report](https://niva.brage.unit.no/niva-xmlui/bitstream/handle/11250/208709/3412_200dpi.pdf?sequence=2&isAllowed=y) suggests default values based on water colour and pH *before* liming (@tbl-ph0-aph). TPKALK also constrains user-supplied values of $pH_0$ to lie in the range 0 to 6, and $A_{pH}$ to be in the range from 0 to 3.

| pH før kalking | Fargetall (mgPt) | $pH_0$ | $A_{pH}$ |
|----------------|------------------|--------|----------|
| 5              | 0                | 3.5    | 1.8      |
| 5              | < 5              | 3.9    | 1.2      |
| < 5            | < 20             | 3.5    | 1.5      |
| 5              | > 20             | 4.3    | 0.7      |

: Suggested values for the parameters $pH_0$ and $A_{pH}$ for lakes with different initial water chemistry (pH and colour). From Table 2 of the [TPKALK report](https://niva.brage.unit.no/niva-xmlui/bitstream/handle/11250/208709/3412_200dpi.pdf?sequence=2&isAllowed=y). {#tbl-ph0-aph}

::: {.callout-tip}
## Simple worked example

Consider a lake with an initial pH of 4.5, colour value of 15 mgPt and a volume of 1 000 000 $m^3$. 50 tonnes of `Miljøkalk EY3` added, which corresponds to a **dose** 50 $g/m^3$ or 50 mg/l of lime. Based on the figure [here](https://nivanorge.github.io/lake_liming_app/column-tests.html#fig-overdosing-curve), the overdosing factor for this lime at 50 mg/l is 2.2, which means around $100 / 2.2 = 45.5 \ %$ of the lime will dissolve rapidly. Furthermore, the calcium content of this lime reported by the manufacturer is 38.5 %. We therefore expect the liming operation to change the concentration of calcium in the lake by $0.45 \times 0.385 \times 50 = 8.75$ mg/l, which corresponds to $\Delta Ca = 437.5 \ \mu ekv/l$. 

Using @tbl-ph0-aph, for this lake $pH_0 = 3.5$ and $A_{pH} = 1.5$. Substituting values into @eq-ph-ca yields an estimate for the pH after liming of around 7.5.
:::

## Mass balance model {#sec-mass-bal-model}

The example above is simplistic, since it ignores factors such as hydrology and the dissolution of lime accumulated on the lake bottom, which can have a significant effect on calcium concentrations in the water. It also only provides an estimate of the initial change in pH due to liming, and not the subsequent evolution of pH over time. 

The original TPKALK model implemented a simple mass balance, where volume of water in the lake, $V$, is assumed to **remain constant** (i.e. the inflow discharge is equal to the outflow discharge at all times). For this model, the rate of change of mass of Ca dissolved in the lake water, $\frac{dM_{lake}}{dt}$ is expressed as a mass balance of sources and sinks (@eq-mass-bal).

$$
\frac{dM_{lake}}{dt} = F_{in} + F_{dose} + F_{bunn} - F_{ut}
$$ {#eq-mass-bal}

Where $F_{in}$, the input flux of calcium, is equal to the inflow discharge, $Q$, multiplied by the inflow concentration, $C_{in}$; and the output flux, $F_{ut}$, is the outflow discharge (also $Q$, since $V$ is assumed constant), multiplied by the lake concentration, $C_{lake}$. @eq-mass-bal can therefore be rewritten as

$$
\frac{dM_{lake}}{dt} = V \frac{dC_{lake}}{dt} = Q C_{in} + F_{dose} + F_{bunn} - Q C_{ut}
$$ {#eq-mass-bal2}

Where $F_{dose}$ is the flux of added lime that dissolves instantly (i.e. the instantaneous dissolution; see above), and $F_{bunn}$ represents the slower dissolution flux from the remaining lime i.e. that which does not dissolve instantly, but instead accumulates on the lake bottom and dissolves over a longer period of time (@fig-box-model).

![Box model for lake calcium concentration under the assumption of fixed water volume.](./images/box_model.png){#fig-box-model}

In the model, $F_{dose}$ is added instantaneously to $C_{lake}$, while the remainder of the calcium that does not dissolve accumulates as a store with initial concentration $B$. The Ca contribution from lime on the lake bottom is assumed to decay exponentially through time

$$
F_{bunn} = K_L B e^{-K_L t}
$$ {#eq-fbunn}

Where $K_L$ is the "deaktiveringskoeffisient", a constant controlling how fast lime on the lake bottom dissolves.