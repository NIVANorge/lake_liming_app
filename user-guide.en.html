<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>User guide – Innsjøkalking applikasjon</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Innsjøkalking applikasjon</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Forside</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./user-guide.html"> 
<span class="menu-text">Brukerhåndboken</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lake-modelling.html"> 
<span class="menu-text">Innsjømodellering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./column-tests.html"> 
<span class="menu-text">Kolonnetester</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.en.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./user-guide.en.html" aria-current="page"> 
<span class="menu-text">User guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lake-modelling.en.html"> 
<span class="menu-text">Lake modelling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./column-tests.en.html"> 
<span class="menu-text">Column tests</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/NIVANorge/lake_liming_app" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-overview" id="toc-sec-overview" class="nav-link active" data-scroll-target="#sec-overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#sec-lake-modelling" id="toc-sec-lake-modelling" class="nav-link" data-scroll-target="#sec-lake-modelling"><span class="header-section-number">2</span> Lake modelling</a>
  <ul class="collapse">
  <li><a href="#sec-liming-products" id="toc-sec-liming-products" class="nav-link" data-scroll-target="#sec-liming-products"><span class="header-section-number">2.1</span> Liming products</a></li>
  <li><a href="#sec-lake-characteristics" id="toc-sec-lake-characteristics" class="nav-link" data-scroll-target="#sec-lake-characteristics"><span class="header-section-number">2.2</span> Lake characteristics</a></li>
  <li><a href="#sec-liming-parameters" id="toc-sec-liming-parameters" class="nav-link" data-scroll-target="#sec-liming-parameters"><span class="header-section-number">2.3</span> Liming parameters</a></li>
  <li><a href="#sec-model-results" id="toc-sec-model-results" class="nav-link" data-scroll-target="#sec-model-results"><span class="header-section-number">2.4</span> Model results</a></li>
  </ul></li>
  <li><a href="#sec-comparison-factors" id="toc-sec-comparison-factors" class="nav-link" data-scroll-target="#sec-comparison-factors"><span class="header-section-number">3</span> Omregningsfaktorer</a></li>
  <li><a href="#sec-column-tests" id="toc-sec-column-tests" class="nav-link" data-scroll-target="#sec-column-tests"><span class="header-section-number">4</span> Column tests</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/NIVANorge/lake_liming_app/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">User guide</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-overview"><span class="header-section-number">1</span> Overview</h2>
<p>The application is online <a href="https://lake-liming.p.niva.no/">here</a> and consists of four separate pages or “tabs”, which are selected from the left sidebar:</p>
<ol type="1">
<li><p><strong>Forside</strong> displays a welcome message and a link to this documentation.</p></li>
<li><p><strong>Innsjømodellering</strong> allows users to:</p>
<ul>
<li>Explore <strong>column test</strong> results for lime products in the application’s database.</li>
<li>Specify <strong>lake characteristics</strong> and <strong>liming parameters</strong>, which are then used to simulate <strong>changes in lake water chemistry</strong> (calcium-equivalent concentration and pH).</li>
</ul></li>
<li><p><strong>Omregningsfaktorer</strong> shows plots comparing the modelled effectiveness of different lime products for a range of lake characteristics (mean depths and water residence times). Generating these plots involves running the model many times, so for efficiency they are pre-computed and presented here for reference.</p></li>
<li><p><strong>Last opp kolonnetestdata</strong> allows users to upload their own column test data (i.e.&nbsp;for lime products not already in the database). Users may download and fill-in an Excel template, which can then be uploaded using the <code>Browse files</code> button. The app will display plots of <strong>instantaneous dissolution</strong> and <strong>overdosing factors</strong> based on the data provided.</p></li>
</ol>
</section>
<section id="sec-lake-modelling" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-lake-modelling"><span class="header-section-number">2</span> Lake modelling</h2>
<p>The <code>Innsjømodellering</code> tab is the main page of the application and is divided into four sections: <code>Liming products</code>, <code>Lake characteristics</code>, <code>Liming parameters</code> and <code>Model results</code>. Under each heading, you will find expandable <code>Help</code> boxes providing tips for how to use the app.</p>
<section id="sec-liming-products" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-liming-products"><span class="header-section-number">2.1</span> Liming products</h3>
<p>Select your product of interest using the drop-down list labelled <code>Choose liming product</code>. The app will display plots of instantaneous dissolution and overdosing factors based on the latest column test data in the database. Click the ellipsis button (<code>[...]</code>) that appears near the top-right of the plot area to export the plots in PNG or SVG format (<a href="#fig-column-test-results" class="quarto-xref">Figure&nbsp;1</a>).</p>
<p>See the <a href="https://nivanorge.github.io/lake_liming_app/column-tests.en.html">Column tests</a> page for a detailed description of the laboratory tests on which these plots are based.</p>
<div id="fig-column-test-results" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-column-test-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/column_test_results.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-column-test-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Column test results for a user-selected lime product. The plots can be saved as PNG or SVG.
</figcaption>
</figure>
</div>
</section>
<section id="sec-lake-characteristics" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-lake-characteristics"><span class="header-section-number">2.2</span> Lake characteristics</h3>
<p>Use the input boxes to enter data for you lake of interest.</p>
<p><code>Surface area</code> and <code>mean depth</code> are used to estimate lake volume. The ratio of lake volume to mean annual discharge volume is the <code>water residence time</code> (in years), which is the length of time, on average, that water spends circulating in the lake. The <code>initial pH</code> of the lake and the <code>inflow pH</code> are used to define the water chemistry at the start of the simulation. For lakes that are unlimed, or which have not been limed for a long time, it can be assumed that <code>initial pH</code> and <code>inflow pH</code> are equal, whereas recently limed lakes will typically have <code>initial pH &gt; inflow pH</code>. If no additional lime is added, the pH of the model lake will tend towards the inflow pH at a rate determined by the water residence time (lakes with shorter residence times reach the inflow pH faster). The Total Organic Carbon (TOC) concentration in the lake is also important, as the presence of organic acids means that more lime will be needed to achieve a given change in pH (see <a href="https://nivanorge.github.io/lake_liming_app/lake-modelling.en.html#sec-ca-ph">Lake moodelling</a> for details).</p>
<p>Users must also specify a <code>Flow profile</code>, which determines the idealised monthly flow regime used by the model (see the plot <a href="https://nivanorge.github.io/lake_liming_app/lake-modelling.en.html#fig-flow-profiles">here</a> for details). Three choices are available:</p>
<ul>
<li><strong>None</strong>. Monthly flows are constant throughout the year.</li>
<li><strong>Fjell</strong>. The profile is characterised by high springtime flows (associated with snow-melting), a wet autumn, and low flows during the winter. Suitable for simulating upland lakes with significant snow accumulation.</li>
<li><strong>Kyst</strong>. The profile is characterised by dry summers with wet autumns and winters. Suitable for lowland lakes with little snow accumulation.</li>
</ul>
<p>If <code>Flow profile</code> is <code>None</code>, the flow rate is determined from the lake volume and water residence time. For <code>Fjell</code> and <code>Kyst</code>, monthly values are scaled to match the chosen pattern, but the mean annual flow rate remains the same (i.e.&nbsp;consistent with the specified lake volume and water residence time).</p>
</section>
<section id="sec-liming-parameters" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-liming-parameters"><span class="header-section-number">2.3</span> Liming parameters</h3>
<p>Use the input boxes to define the liming schedule. The <code>lime dose</code> is the amount of product added divided by the volume of water limed. In cases where lime is only spread over part of a lake’s surface, use <code>Proportion of lake surface area limed</code> to specify the extent of liming. If this value is less than one, it is assumed that the lake depth profile is such that liming e.g.&nbsp;half of the surface area is equivalent to liming half of the lake volume.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The model assumes that the lake eventually becomes well-mixed, regardless of the areal extent of liming. Adding 10 mg/l of lime product over the whole lake is therefore similar to adding 20 mg/l over 50% of the surface area. However, in the latter case, <strong>overdosing effects</strong> will modify the instantaneous dissolution, meaning that slightly less lime will dissolve immediately and more will sink to the lake bottom (and potentially dissolve later). See the <a href="https://nivanorge.github.io/lake_liming_app/lake-modelling.en.html#sec-mass-bal-model">Lake modelling</a> page for details.</p>
</div>
</div>
<p><code>Application method</code> can be either <code>Wet</code> or <code>Dry</code>, where <code>Wet</code> corresponds to adding lime as a slurry (e.g.&nbsp;from a boat) and <code>Dry</code> corresponds to adding raw material directly without any pre-mixing (e.g.&nbsp;from a helicopter). Dry lime dissolves in lake water more slowly than slurry. If <code>Dry</code> is selected, instantaneous dissolution values from the column tests are adjusted downwards to account for this.</p>
<p><code>Application month</code> is the month of the year in which liming takes place and <code>Number of months to simulate</code> determines the length of time series generated. If <code>Flow profile</code> is set to <code>None</code> (<a href="#sec-lake-characteristics" class="quarto-xref">Section&nbsp;2.2</a>), <code>Application month</code> will have no effect, because flows remain constant throughout the year. However, for the <code>Fjell</code> and <code>Kyst</code> profiles application month can be important - especially for upland lakes with short residence times, where water is cycled quickly during spring snow-melt episodes.</p>
</section>
<section id="sec-model-results" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-model-results"><span class="header-section-number">2.4</span> Model results</h3>
<p>Changing values in any of the input boxes will automatically trigger an update of the model results. While this happens, a <code>RUNNING</code> message will be displayed at the top-right of the screen.</p>
<p>When the model run is finished, the application will display idealised time series of Ca-equivalent concentration and pH for the number of months specified. Simulations are produced for all lime products in the database, making it easy to compare results for different products.</p>
<p><strong>The plots are interactive</strong> - expand the <code>Help</code> section under the <code>Model results</code> heading for an overview of how to explore them.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Time series produced by the model are based on generalised/typical relationships that do not account for local factors (which may be important). Results indicate the expected response of a typical lake, but are not intended for detailed, site-specific assessments.</p>
</div>
</div>
</section>
</section>
<section id="sec-comparison-factors" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-comparison-factors"><span class="header-section-number">3</span> Omregningsfaktorer</h2>
<p>Plots of “omregningsfaktorer” are a convenient way to compare the simulated effectiveness of different lime products in lakes with different characteristics. To generate the plots, initial conditions are defined for a broad range of lakes with varying mean depth and water residence time. The model is then run many times to identify how much of each lime product would be required to achieve a given pH target after some period of time (e.g.&nbsp;one year).</p>
<p>For each lime product, the amount of lime required (in tonnes) is compared to results for a standard “reference” product to give the <strong>omregningsfaktor</strong>. The reference used by this application is <code>Standard Kalk Kat3</code>. Values less than one indicate the product being tested is more effective than the standard, while values greater than one imply it is less effective (per unit mass).</p>
<p>In principle, these plots could be constructed manually using the <code>Innsjømodellering</code> page. However, the number of parameter combinations is large, so for efficiency they are pre-computed for all lime products in the database and presented on this page in summary form. Plots are generated for lakes with mean depths of 5, 10, 15 and 20 m, and curves shown for lakes with water residence times ranging from 0.3 to 2 years.</p>
<p>Differences between products on these plots reflect the different physical and chemical properties of the limes, as represented by the <a href="https://nivanorge.github.io/lake_liming_app/column-tests.en.html">column test</a> data.</p>
</section>
<section id="sec-column-tests" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-column-tests"><span class="header-section-number">4</span> Column tests</h2>
<p>The <code>Laste opp kolonnetestdata</code> page can be used to create plots of <strong>instantaneous dissolution</strong> and <strong>overdosing factors</strong> based on user-supplied column test data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can explore column test results for lime products that are <em>already in the application’s database</em> from the <code>Innsjømodellering</code> tab.</p>
</div>
</div>
<p>To create plots based on your own data, first download a blank copy of the Excel input template from <a href="https://github.com/NIVANorge/lake_liming_app/raw/main/data/liming_app_data_template_v1-1.xlsx">here</a>. Fill-in the template and save the changes on your local machine, then upload the completed Excel file to the web application by clicking the <code>Browse files</code> button in the left sidebar. The app will display plots of instantaneous dissolution and overdosing factors based on the data you provide.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data uploaded via the <code>Laste opp kolonnetestdata</code> tab is not immediately added to the application database. If you want to add a new product to the application (or update information for an existing one), first fill-in the Excel template and check the plots look reasonable. You can then <a href="mailto:james.sample@niva.no">send the completed template to NIVA</a> for inclusion in the product database.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/nivanorge\.github\.io\/lake_liming_app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Created by <a href="https://www.niva.no/"><img src="https://gcenode.no/wp-content/uploads/L-NIVA.png" class="img-fluid" alt="NIVA" width="65"></a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/NIVANorge/lake_liming_app/issues" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>