<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Vassdragskalking applikasjon - Lake modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Vassdragskalking applikasjon</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lake-modelling.html" rel="" target="">
 <span class="menu-text">Lake modelling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./column-tests.html" rel="" target="">
 <span class="menu-text">Column tests</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lake-modelling.html">Lake modelling</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-collapse-item" href="https://github.com/NIVANorge/lake_liming_app">
            GitHub repository
            </a>
          </li>
      </ul>
    </div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lake-modelling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lake modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./column-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Column tests</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-background" id="toc-sec-background" class="nav-link active" data-scroll-target="#sec-background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
  <li><a href="#sec-lime-types" id="toc-sec-lime-types" class="nav-link" data-scroll-target="#sec-lime-types"><span class="header-section-number">1.1</span> Types of liming material</a></li>
  <li><a href="#sec-solubility" id="toc-sec-solubility" class="nav-link" data-scroll-target="#sec-solubility"><span class="header-section-number">1.2</span> Lime solubility</a></li>
  </ul></li>
  <li><a href="#sec-modelling" id="toc-sec-modelling" class="nav-link" data-scroll-target="#sec-modelling"><span class="header-section-number">2</span> Modelling procedure</a>
  <ul class="collapse">
  <li><a href="#sec-ca-ph" id="toc-sec-ca-ph" class="nav-link" data-scroll-target="#sec-ca-ph"><span class="header-section-number">2.1</span> Relationship between Ca-equivalents and pH</a></li>
  <li><a href="#sec-mass-bal-model" id="toc-sec-mass-bal-model" class="nav-link" data-scroll-target="#sec-mass-bal-model"><span class="header-section-number">2.2</span> Mass balance model</a></li>
  <li><a href="#sec-inst-diss" id="toc-sec-inst-diss" class="nav-link" data-scroll-target="#sec-inst-diss"><span class="header-section-number">2.3</span> Estimating instantaneous dissolution</a></li>
  <li><a href="#sec-standard-lake" id="toc-sec-standard-lake" class="nav-link" data-scroll-target="#sec-standard-lake"><span class="header-section-number">2.4</span> Simulating a “standard lake”</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lake modelling</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The calculations performed by the application and described on this page are a subset of those implemented by the original <a href="https://niva.brage.unit.no/niva-xmlui/handle/11250/208709">TPKALK application</a> developed by NIVA during the 1990s.</p>
<section id="sec-background" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-background"><span class="header-section-number">1</span> Background</h2>
<section id="sec-lime-types" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="sec-lime-types"><span class="header-section-number">1.1</span> Types of liming material</h3>
<p>Lime products used for catchment management are usually a mixture of <strong>calcium carbonate</strong> (calcite, <span class="math inline">\(CaCO_3\)</span>) and <strong>magnesium carbonate</strong> (<span class="math inline">\(MgCO_3\)</span>). Rocks composed primarily of <span class="math inline">\(CaCO_3\)</span> are commonly called <strong>limestones</strong> and <strong>chalks</strong>, whereas carbonate rocks with significant proportions of magnesium are called <strong>dolomites</strong> (&gt; 10% Mg) or magnesian limestones (2 to 10% Mg).</p>
<p>Lime manufacturers will typically specify the proportion of calcium and magnesium carbonate in their products. For example, <code>Microdol5</code> is reported as being 53.7% <span class="math inline">\(CaCO_3\)</span> and 44.4% <span class="math inline">\(MgCO_3\)</span> by mass (with 1.9% other impurities).</p>
<p>Magnesium carbonate has a higher proportion of carbonate by mass (and therefore a greater acid neutralising capacity; ANC) than calcium carbonate: 1 g of magnesium carbonate will neutralise as much acid as 1.19 g of calcium carbonate. When comparing limes with different compositions, it is therefore necessary to multiply the magnesium carbonate proportion by a factor of 1.19. This gives a <strong>neutralising value (NV)</strong>, estimated as the sum of calcium carbonate <em>equivalents</em> (e.g. <a href="#tbl-nv">Table&nbsp;1</a>). The NV is best determined by titration according to EN-12945. It may also be estimated from Ca and Mg element analyses, but in some cases these elements may be fixed to minerals other than carbonates with little or no neutralising capacity.</p>
<div id="tbl-nv" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Estimating the <strong>neutralising value (NV)</strong> for two lime products. <span class="math inline">\(MgCO_3\)</span> content is converted to <span class="math inline">\(CaCO_3\)</span>-equivalents by multiplying by 1.19.</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 25%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><strong>Product</strong></th>
<th style="text-align: center;"><strong>CaCO3 (%)</strong></th>
<th style="text-align: center;"><strong>MgCO3 (%)</strong></th>
<th style="text-align: center;"><strong>MgCO3 (CaCO3-ekv; %)</strong></th>
<th style="text-align: center;"><strong>NV (sum of CaCO3-ekv; %)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Microdol5</strong></td>
<td style="text-align: center;">53.7</td>
<td style="text-align: center;">44.4</td>
<td style="text-align: center;">52.8</td>
<td style="text-align: center;">106.5</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>VK3</strong></td>
<td style="text-align: center;">99.0</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">100.2</td>
</tr>
</tbody>
</table>
</div>
<p>The NV is usually specified in percent: pure calcium carbonate has a NV of 100 %; pure magnesium carbonate has a NV of 119 %; and typical dolomite products have NVs that are somewhere in between. For the same mass, products with a higher NV will be more effective at increasing pH, <em>as long as all the lime dissolves</em>. In practice, different limes exhibit different dissolution rates, which must also be accounted for (<a href="#sec-solubility">Section&nbsp;1.2</a>).</p>
</section>
<section id="sec-solubility" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="sec-solubility"><span class="header-section-number">1.2</span> Lime solubility</h3>
<p>Several factors affect the dissolution rate of lime material added to a waterbody. These include:</p>
<ul>
<li><p><strong>Physical</strong> and <strong>chemical</strong> properties of the liming material (crystal structure etc.).</p></li>
<li><p><strong>Particle size</strong> (i.e.&nbsp;fineness) of the lime material. Smaller particles give a larger reaction surface and therefore dissolve faster.</p></li>
<li><p><strong>Water pH</strong>. More acidic lakes react with the lime more vigorously.</p></li>
<li><p><strong>Application method</strong> (for example from a boat versus from a helicopter).</p></li>
<li><p>Amount of lime added, usually called the <strong>dose</strong>. If large amounts of lime are added to a lake all at once, the overall effect on pH is less than might be achieved if smaller amounts were added more regularly. This is because, at high doses, pH and calcium concentration increase in the immediate vicinity of the lime particles, which then sink to the bottom without dissolving efficiently. It is also more likely that lime particles will clump together and sink more rapidly. This effect is called <strong>overdosing</strong>.</p></li>
</ul>
<p>Most commercial lime products are fine enough to dissolve effectively. For a given application method and lake pH, the goal is therefore to identify <strong>which lime product to use</strong> (i.e.&nbsp;which physical and chemical properties to select) and <strong>in what dose</strong> (to minimise the number of applications necessary, without excessive waste due to overdosing).</p>
<p>Lime dissolution rates and the effects of overdosing are determined experimentally - see the <a href="./column-tests.html">column tests</a> page for details.</p>
</section>
</section>
<section id="sec-modelling" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-modelling"><span class="header-section-number">2</span> Modelling procedure</h2>
<p><strong>The overall goal is to model changes in lake pH due to liming with different products</strong>. The model provides one part of the evidence base to decide which lime products to apply under different circumstances.</p>
<section id="sec-ca-ph" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="sec-ca-ph"><span class="header-section-number">2.1</span> Relationship between Ca-equivalents and pH</h3>
<p>When we add liming material, the concentration of CaCO3 (and MgCO3, if relevant) in the lake increases, which leads to an increase in pH. <a href="#fig-titration-curves">Figure&nbsp;1</a> shows relationships derived empirically by Atle Hindar relating changes in CaCO3-equivalents to changes in pH for lakes with different concentrations of Total Organic Carbon (TOC).</p>
<div id="fig-titration-curves" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/titration_curves.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Titration curves relating changes in CaCO3-equivalents to changes in pH for lakes with different Total Organic Carbon (TOC) concentrations.</figcaption>
</figure>
</div>
<p>For a lake with a given initial pH and TOC concentration, the model uses sigmoid curves based on the empirical data (<a href="#fig-titration-curves-interpolated">Figure&nbsp;2</a>) to lookup an initial (idealised) CaCO3 concentration representing the initial buffering capacity of the lake. The model then simulates changes in CaCO3-equivalent concentrations over time (relative to the initial concentration), and uses the curves to estimate corresponding changes in pH.</p>
<div id="fig-titration-curves-interpolated" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/titration_curves.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Sigmoid curves fitted to the data in <a href="#fig-titration-curves">Figure&nbsp;1</a>. These are used by the model to convert changes in CaCO3-equivalents to changes in pH for lakes with different Total Organic Carbon (TOC) concentrations.</figcaption>
</figure>
</div>
</section>
<section id="sec-mass-bal-model" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="sec-mass-bal-model"><span class="header-section-number">2.2</span> Mass balance model</h3>
<p>The titration curves in <a href="#fig-titration-curves-interpolated">Figure&nbsp;2</a> transform the problem of modelling pH into one of modelling <span class="math inline">\(\Delta Ca\)</span> (and <span class="math inline">\(\Delta Mg\)</span> too, if relevant). When we add lime to a lake, some of it dissolves instantly, giving a sudden increase in pH, while the remainder sinks to the bottom and dissolves more slowly.</p>
<p>A mass balance “box model” (<a href="#fig-box-model">Figure&nbsp;3</a>) is used to provide an estimate of both the initial change in lake conditions due to liming and the subsequent evolution over time. For simplicity, only one set of calculations is shown (e.g.&nbsp;for calcium), but an identical set of calculations for magnesium are also performed in parallel, if relevant. The Mg-fraction is then converted to CaCO3-equivalents before making the link to changes in pH (<a href="#sec-ca-ph">Section&nbsp;2.1</a>). Taking calcium as an example, the symbols in <a href="#fig-box-model">Figure&nbsp;3</a> are as follows:</p>
<ul>
<li><span class="math inline">\(D\)</span> is the dose of lime added (adjusted for Ca content i.e.&nbsp;the actual dose of Ca in mg/l)</li>
<li><span class="math inline">\(C_{inst}\)</span> is the “immediate” increase in lake Ca concentration (in mg/l) due to <strong>instantaneous dissolution</strong></li>
<li><span class="math inline">\(C_{bott} = F_{active} (D - C_{inst})\)</span> is the amount of Ca (in mg/l) that sinks to the lake bottom and remains active for dissolution. Note that <span class="math inline">\((D - C_{inst})\)</span> is the total amount of lime that sinks to the bottom, and <span class="math inline">\(F_{active}\)</span> is the proportion of this that remains “active”. Typical values for <span class="math inline">\(F_{active}\)</span> are around 0.4, based on the observation that about 60% of the lime arriving on the lake bottom becomes “deactivated” and never dissolves.</li>
<li><span class="math inline">\(F_{slow}\)</span> is the rate at which concentration increases (in mg/l/month) due to dissolution of the bottom layer</li>
<li><span class="math inline">\(C_{in}\)</span> and <span class="math inline">\(C_{out}\)</span> are the inflow and outflow concentrations of Ca, respectively (both in mg/l)</li>
<li><span class="math inline">\(V\)</span> is the lake volume in litres. The lake is assumed to be in <strong>steady state</strong> i.e.&nbsp;<span class="math inline">\(V\)</span> is constant</li>
<li><span class="math inline">\(Q\)</span> is the discharge in l/month. To satisfy the steady state assumption, the inflow discharge must equal the outflow discharge</li>
<li><span class="math inline">\(M_{lake}\)</span> is the mass of Ca dissolved in the lake water (in mg)</li>
<li><span class="math inline">\(C_{lake}\)</span> is the Ca concentration in the lake, equal to <span class="math inline">\(\frac{M_{lake}}{V}\)</span>. The lake is assumed to be <strong>well mixed</strong>, such that the outflow concentration, <span class="math inline">\(C_{out}\)</span>, is equal to <span class="math inline">\(C_{lake}\)</span></li>
</ul>
<div id="fig-box-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/box_model.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Schematic illustration of a box model for lake calcium concentration for a single lake under the assumption of fixed water volume. Symbols are defined in the text.</figcaption>
</figure>
</div>
<p>Balancing the main sources and sinks of Ca to the lake gives</p>
<p><span id="eq-dMlake_dt"><span class="math display">\[
\frac{dM_{lake}}{dt} = V \frac{dC_{lake}}{dt} = Q C_{in} - Q C_{lake} + V C_{inst} + V F_{slow}
\tag{1}\]</span></span></p>
<p>or</p>
<p><span id="eq-dClake_dt"><span class="math display">\[
\frac{dC_{lake}}{dt} = \frac{Q C_{in} - Q C_{lake}}{V} + C_{inst} + F_{slow}
\tag{2}\]</span></span></p>
<p>Lime that does not dissolve instantly sinks to the bottom of the lake and dissolves more slowly. Dissolution of lake-bottom lime is modelled as a first-order reaction with initial rate coefficient <span class="math inline">\(K_0\)</span>. However, this rate coefficient is assumed to decay exponentially over time, reflecting the observation that lime accumulating in lake sediments becomes less “active” over time and dissolves more slowly. The rate at which the reaction coefficient decays is controlled by the “activity coefficient” <span class="math inline">\(\lambda\)</span></p>
<p><span id="eq-Kt"><span class="math display">\[
K_t = K_0 e^{- \lambda t}
\tag{3}\]</span></span></p>
<p>where <span class="math inline">\(K_t\)</span> is the first order reaction coefficient at time <span class="math inline">\(t\)</span>.</p>
<p>The effective rate coefficient, <span class="math inline">\(K_t\)</span>, is further modified by a “rate factor”, <span class="math inline">\(R\)</span>, which reduces the dissolution rate as concentrations of dissolved CaCO3 in the lake become high. In particular, <span class="math inline">\(R\)</span> forces the coefficient <span class="math inline">\(K_t\)</span> towards zero as dissolved concentrations approach saturation. This is done primarily to ensure the model’s output remains plausible even if users set extreme parameter values in the user interface; for most realistic choices of input parameters, lake concentrations will not approach saturation and the value of <span class="math inline">\(R\)</span> will be close to 1.</p>
<p><span id="eq-R"><span class="math display">\[
R = \frac{1}{1 + e^{10 (C_{lake} - C_{sat})}}
\tag{4}\]</span></span></p>
<p>where <span class="math inline">\(C_{sat}\)</span> is the saturation concentration of Ca in lake water (i.e.&nbsp;the maximum value permitted by the model).</p>
<p><span id="eq-dCslow_dt"><span class="math display">\[
F_{slow} = - \frac{dC_{bott}}{dt} = C_{bott} K_t R
\tag{5}\]</span></span></p>
</section>
<section id="sec-inst-diss" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="sec-inst-diss"><span class="header-section-number">2.3</span> Estimating instantaneous dissolution</h3>
<p>For the model to produce reasonable simulations, it is important to have an accurate estimate for the proportion of lime material that dissolves quickly (i.e.&nbsp;the instantaneous dissolution fraction, <span class="math inline">\(C_{inst}\)</span>). Instantaneous dissolution can be measured in the laboratory using <a href="./column-tests.html">column tests</a>, which tell us how much lime will typically dissolve in a column given a known initial pH and lime dose. However, before the column test data can be used for lake modelling, it is necessary to adjust for:</p>
<ul>
<li><p><strong>Spreading method</strong>. For dry spreading (e.g.&nbsp;by helicopter) the amount of lime material that dissolves immediately is typically 0.5 to 0.7 times the proportion predicted by column tests (see Sverdrup Table 3; Espen Enge used 0.8 for much of his work). No adjustment is required for wet spreading (e.g.&nbsp;from a boat).</p></li>
<li><p><strong>Lake depth</strong>. Deeper lakes give the lime more time to dissolve as it sinks. In his PhD thesis, <a href="https://www.osti.gov/etdeweb/biblio/7808260">Sverdrup (1985)</a> noted that, for CaCO3, the instantaneous dissolution is directly proportional to both <span class="math inline">\(H^+\)</span> concentration and sinking depth</p></li>
</ul>
<p><span id="eq-diss-h-depth"><span class="math display">\[
D_{inst} \propto [H^+] \times d
\tag{6}\]</span></span></p>
<p>It is therefore possible to generalise instantaneous dissolution estimates from fixed-depth column tests to lakes with different depths by considering compensating changes in pH. For example, the expected dissolution for lake of depth <span class="math inline">\(d\)</span> and hydrogen ion concentration <span class="math inline">\(H^+\)</span> is the same as for a lake with depth <span class="math inline">\(2d\)</span> and hydrogen ion concentration <span class="math inline">\(0.5H^+\)</span>. Re-writing in terms of pH, the instantaneous dissolution for a lake of depth <span class="math inline">\(d_{lake}\)</span> and initial pH <span class="math inline">\(X\)</span> is assumed to be similar to the dissolution in a test column of depth <span class="math inline">\(d_{col}\)</span> with pH <span class="math inline">\((X - a)\)</span> where</p>
<p><span id="eq-cor-depth"><span class="math display">\[
a = log⁡(\frac{d_{lake}}{d_{col}})
\tag{7}\]</span></span></p>
<p>Note that <a href="#eq-cor-depth">Equation&nbsp;7</a> applies to the CaCO3 fraction; for MgCO3, Sverdrup proposed the modification <span class="math inline">\((X - 0.5a)\)</span> as a more appropriate depth correction.</p>
</section>
<section id="sec-standard-lake" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="sec-standard-lake"><span class="header-section-number">2.4</span> Simulating a “standard lake”</h3>
<p>The model defined above is capable of simulating how pH and Ca concentration (and Mg, if relevant) change over time for a single lake. The model requires the following iinputs:</p>
<ul>
<li><p>Lake <strong>volume</strong> (often provided as surface area and mean depth) and <strong>discharge</strong>, which together define the <strong>residence time</strong>. Note that this model assumes the volume is fixed, but discharge can vary over time, if desired.</p></li>
<li><p><strong>Initial pH and TOC concentration</strong> for the lake. The lake is initially assumed to be in “steady state” i.e.&nbsp;the inflow concentration of Ca is equal to the outflow concentration.</p></li>
<li><p>The <strong>dose</strong> of liming material added and the <strong>proportion of Ca and Mg by mass</strong> in the lime. <strong>Overdosing factors</strong> are also relevant for higher doses.</p></li>
<li><p><strong>Lake mean depth</strong> and <strong>Spreading method</strong> (i.e.&nbsp;“wet” or “dry”), both of which are used to adjust the instantaneous dissolution values from column tests (<a href="#eq-cor-depth">Equation&nbsp;7</a>).</p></li>
<li><p><strong>The fraction of the lime on the lake bottom that remains “active”</strong> for dissolution over long time periods.</p></li>
<li><p>The parameter <span class="math inline">\(K_L\)</span> (for both Ca and Mg), which determines how fast “active” lime on the lake bottom dissolves.</p></li>
</ul>
<p>To avoid having to specify all these parameters when comparing different lime products, it is common to consider a <strong>standard lake</strong> with an area of 20 ha, mean depth of 5 m and mean residence time of 0.7 years. These parameters, in turn, define the mean annual discharge. If desired, this can be modified by selecting a monthly <strong>flow profile</strong> (<code>fjell</code> or <code>kyst</code>; see <a href="#fig-flow-profiles">Figure&nbsp;4</a>), which adjusts the flows up or down in each month, but in such a way that the overall annual average maintains a residence time of 0.7 years.</p>
<div id="fig-flow-profiles" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/flow_typologies.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Monthly flow profiles that can be used to modify the default (constant) flows assumed for the “standard lake”.</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>